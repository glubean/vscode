# Glubean Telemetry

Glubean is **opt-in** — telemetry is disabled by default and is never collected without your explicit consent.

## How to opt in

You will be prompted once, after your first successful test run. You can also enable or disable it at any time:

1. Open VS Code Settings (`Cmd+,` / `Ctrl+,`)
2. Search for `glubean telemetry`
3. Toggle **Glubean › Telemetry: Enabled**

Or via the command palette:
```
Preferences: Open Settings (UI) → search "glubean telemetry"
```

## What is collected

When enabled, Glubean sends anonymous, structured usage events to [PostHog](https://posthog.com). Each event includes:

| Field | Value |
|---|---|
| `distinctId` | `vscode.env.machineId` — an anonymous, non-personal machine identifier generated by VS Code |
| `os` | Operating system platform (`darwin`, `win32`, `linux`) |
| `vscode_version` | VS Code version string (e.g. `1.88.0`) |
| `extension_version` | Glubean extension version (e.g. `0.3.0`) |

### Events

**`session_start`**
Fired once when the extension activates. No additional properties.

**`test_run`**
Fired after a test run completes.

| Property | Type | Description |
|---|---|---|
| `test_count` | number | Number of test items in the run |
| `duration_ms` | number | Total run duration in milliseconds |
| `location` | `"explore"` \| `"tests"` \| `"other"` | Which directory the test file is in |

**`trace_opened`**
Fired when a `.trace.jsonc` file is opened in the trace viewer.

| Property | Type | Description |
|---|---|---|
| `via` | `"auto"` \| `"manual"` | Whether the trace was opened automatically after a run, or manually |

**`env_switched`**
Fired when the user switches the active `.env` file via the status bar. No additional properties.

**`run_error`**
Fired when a test run encounters an execution error.

| Property | Type | Description |
|---|---|---|
| `error_type` | string | Classified error category (see below) |

Error type values: `deno_not_found`, `syntax_error`, `network_error`, `import_error`, `assertion_failed`, `unknown`.

## What is never collected

- File paths, directory names, or project names
- Test names, test IDs, or any test content
- API URLs, hostnames, or request/response data
- Environment variable names or values
- Secret values or credentials
- Error messages (only classified error *types* are sent)
- Any personally identifiable information (PII)
- IP addresses (PostHog is configured to not store them)

## How data is used

Telemetry helps us answer questions like:

- Are users forming daily habits with the tool?
- Which features (multi-step tests, data-driven, trace diff) are actually being used?
- What errors are most common during installation or first run?
- How long do test runs take across different setups?

This data informs which features to improve, what documentation to write, and where the biggest friction points are.

## Who processes the data

Usage events are sent to [PostHog](https://posthog.com), a product analytics platform. Events are associated with an anonymous `machineId` only — there is no account, email, or personal identifier involved at any point.

PostHog's privacy policy: https://posthog.com/privacy

## Open source

The telemetry implementation is fully visible in the extension source:
[`src/telemetry.ts`](../src/telemetry.ts)

You can verify exactly what is sent by reading the source code.
